<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>McBongu's - Dharwad Restaurant Guide</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles-main.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Bacasime+Antique&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="top-bar">
        <div class="mc">
            <a href="/">McBongu's</a>
        </div>
        <div class="nav-links">
            <a href="/" class="active">Home</a>
            <a href="/restaurants">Restaurants</a>
            <a href="/restaurants">Offers</a>
            <a href="/about">About Us</a>
        </div>
        <button class="top-button">
            <img src="{{ url_for('static', filename='images/bar.png') }}" alt="Menu">
        </button>
    </div>
    
    <div class="below-bar"></div>

    <div class="container">
        <div class="hero-content">
            <h1>Browse Restaurants</h1>
            <p class="tagline">Discover the best eats in Dharwad!</p>
            <div class="search-container">
                <input type="text" placeholder="Search for restaurants..." id="searchInput">
                <button class="search-btn" id="searchBtn">
                    <img src="/static/images/glass.png" alt="glass" style="height: 30px; width: 30px;">
                </button>
            </div>
        </div>
        <div class="restaurant-grid" id="restaurantGrid">
            <div class="restaurant-card" data-restaurant-id="1" data-restaurant-name="The S Jail Hotel" data-rating="3.7">
                <div class="restaurant-image" style="background-image: url('https://images.unsplash.com/photo-1701579231305-d84d8af9a3fd?q=80&w=1974&auto=format&fit=crop');"></div>
                <div class="restaurant-info">
                    <h3>The S Jail Hotel</h3>
                    <p>Get arrested with food</p>
                    <div class="rating">
                        <span>3.7 ★</span>
                    </div>
                    <span class="delivery-time"><i class="fas fa-clock"></i> 25-35 min</span>
                    <button class="view-menu">View Menu</button>
                </div>
            </div>
            <div class="restaurant-card" data-restaurant-id="2" data-restaurant-name="KFC" data-rating="4.0">
                <div class="restaurant-image" style="background-image: url('https://images.unsplash.com/photo-1550547660-d9450f859349?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');"></div>
                <div class="restaurant-info">
                    <h3>KFC</h3>
                    <p>It's finger lickin' good!</p>
                    <div class="rating">
                        <span>4.0 ★</span>
                    </div>
                    <span class="delivery-time"><i class="fas fa-clock"></i> 30-45 min</span>
                    <button class="view-menu">View Menu</button>
                </div>
            </div>
            <div class="restaurant-card" data-restaurant-id="3" data-restaurant-name="Disha Darshini" data-rating="4.6">
                <div class="restaurant-image" style="background-image: url('https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');"></div>
                <div class="restaurant-info">
                    <h3>Disha Darshini</h3>
                    <p>Quality breakfast!</p>
                    <div class="rating">
                        <span>4.6 ★</span>
                    </div>
                    <span class="delivery-time"><i class="fas fa-clock"></i> 20-30 min</span>
                    <button class="view-menu">View Menu</button>
                </div>
            </div>
            <div class="restaurant-card" data-restaurant-id="4" data-restaurant-name="Pizza Hut" data-rating="4.6">
                <div class="restaurant-image" style="background-image: url('https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');"></div>
                <div class="restaurant-info">
                    <h3>Pizza Hut</h3>
                    <p>Quality pizza!</p>
                    <div class="rating">
                        <span>4.6 ★</span>
                    </div>
                    <span class="delivery-time"><i class="fas fa-clock"></i> 40-55 min</span>
                    <button class="view-menu">View Menu</button>
                </div>
            </div>
        </div>
    </div>
    

    <!-- Menu Modal -->
    <div class="menu-modal" id="menuModal">
        <div class="menu-content">
            <h2 id="restaurantName"></h2>
            <p id="restaurantRating"></p>
            <div id="menuItems"></div>
            <div class="total-price" id="totalPrice">Total: ₹0.00</div>
            <button id="proceedToPayment">Proceed to Payment</button>
            <div class="payment-gateway" id="paymentGateway">
                <h3>Payment Gateway</h3>
                <p>Simulated Payment Screen (Integration with real gateway like Razorpay/Stripe would go here)</p>
                <button id="payNowButton">Pay Now</button>
            </div>
            <button class="close-modal" onclick="document.getElementById('menuModal').style.display='none'">Close</button>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>McBongu's</h4>
                <p>The best food delivery service in town. Fast, fresh, and friendly.</p>
            </div>
            <div class="footer-section">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="/about">About Us</a></li>
                    <li><a href="/about">Contact</a></li>
                    <li><a href="/about">FAQ</a></li>
                    <li><a href="/about">Terms of Service</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Contact Us</h4>
                <p><i class="fas fa-map-marker-alt"></i> 123 Delivery St, Food City</p>
                <p><i class="fas fa-phone"></i> (555) 123-4567</p>
                <p><i class="fas fa-envelope"></i> rishik.natra.work@gmail.com</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>© 2025 McBongu's - All Rights Reserved</p>
            <div class="social-icons">
                <a href="#"><i class="fab fa-facebook-f"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
            </div>
        </div>
    </footer>

    <script>
        // Existing menu modal script
        document.querySelectorAll('.view-menu').forEach(button => {
            button.addEventListener('click', async (e) => {
                const card = e.target.closest('.restaurant-card');
                const restaurantId = card.dataset.restaurantId;
                const restaurantName = card.dataset.restaurantName;
                const rating = card.dataset.rating;
    
                const modal = document.getElementById('menuModal');
                document.getElementById('restaurantName').textContent = restaurantName;
                document.getElementById('restaurantRating').textContent = `Rating: ${rating} ★`;
                modal.style.display = 'block';
    
                const response = await fetch(`/menu/${restaurantId}`);
                const menuItems = await response.json();
    
                const menuContainer = document.getElementById('menuItems');
                menuContainer.innerHTML = '';
                let total = 0;
    
                menuItems.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'menu-item';
                    div.innerHTML = `
                        <span>${item.item_name} - ₹${item.price}</span>
                        <input type="number" min="0" value="0" data-price="${item.price}" data-id="${item.id}" oninput="updateTotal()">
                    `;
                    menuContainer.appendChild(div);
                });
    
                window.updateTotal = () => {
                    total = 0;
                    document.querySelectorAll('#menuItems input[type="number"]').forEach(input => {
                        const quantity = parseInt(input.value) || 0;
                        const price = parseFloat(input.dataset.price);
                        total += quantity * price;
                    });
                    document.getElementById('totalPrice').textContent = `Total: ₹${total.toFixed(2)}`;
                };
    
                document.getElementById('proceedToPayment').onclick = () => {
                    if (total > 0) {
                        document.getElementById('paymentGateway').style.display = 'block';
                    } else {
                        alert('Please select at least one item to proceed.');
                    }
                };
    
                document.getElementById('payNowButton').onclick = async () => {
                    const selectedItems = [];
                    document.querySelectorAll('#menuItems input[type="number"]').forEach(input => {
                        const quantity = parseInt(input.value) || 0;
                        if (quantity > 0) {
                            selectedItems.push({
                                menu_id: input.dataset.id,
                                quantity: quantity
                            });
                        }
                    });
    
                    const orderData = {
                        restaurant_id: restaurantId,
                        items: selectedItems,
                        total_price: total
                    };
                    console.log('Sending order data:', orderData);
                    const response = await fetch('/place_order', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(orderData)
                    });
                    const result = await response.json();
    
                    if (response.ok) {
                        alert('Payment Successful! Order placed.');
                        window.location.href = `/order_tracking/${result.order_id}`;
                    } else {
                        alert('Order placement failed: ' + result.error);
                    }
                    modal.style.display = 'none';
                };
            });
        });
    
        // New search functionality
        const searchInput = document.getElementById('searchInput');
        const searchBtn = document.getElementById('searchBtn');
        const restaurantGrid = document.getElementById('restaurantGrid');
    
        function filterRestaurants() {
            const query = searchInput.value.toLowerCase();
            const restaurants = restaurantGrid.querySelectorAll('.restaurant-card');
    
            restaurants.forEach(card => {
                const name = card.dataset.restaurantName.toLowerCase();
                if (name.includes(query)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }
    
        searchBtn.addEventListener('click', filterRestaurants);
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                filterRestaurants();
            }
        });
    </script>
</body>
</html>